Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    31     62.5 MiB     62.5 MiB           1   @profile(stream=fp)
    32                                         # Instantiate loggers and log that application has started
    33                                         def to_event_log(message):
    34                                             '''
    35                                             Temporary event logger until implementation of logging logger.
    36                                             For general script information event logging.
    37                                             :param message: (string) Event log message
    38                                             '''
    39     62.5 MiB      0.0 MiB           1       event_log = open(f"{script_root_dir}\\events.log", "a")
    40     62.5 MiB      0.0 MiB           1       event_log.write(f"{datetime.now()}: {message}")
    41     62.5 MiB      0.0 MiB           1       event_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    83     62.5 MiB     62.5 MiB           1   @profile(stream=fp)
    84                                         # Functions
    85                                         def set_tag(_tags):
    86                                             """
    87                                             Builds and returns a tuple of Tag objects.  Case statement needed to control DT object assignments to Tag object.
    88                                             :param _tags: A dictionary containing the registry as a key and data type as a value. (i.e., {"D10": "SWORD"})
    89                                             :return: A tuple of Melsec Tag objects
    90                                             """
    91     62.5 MiB      0.0 MiB           1       _read_tags = []
    92     62.5 MiB      0.0 MiB           8       for registry in _tags:
    93     62.5 MiB      0.0 MiB           7           print(f'data_type: {str(_tags[registry].upper())}')
    94     62.5 MiB      0.0 MiB           7           match str(_tags[registry].upper()):
    95     62.5 MiB      0.0 MiB           7               case "BIT":
    96                                                         _read_tags.append(Tag(device=str(registry), type=DT.BIT))  # Bit = 1 Bit (obviously...)
    97     62.5 MiB      0.0 MiB           7               case "SWORD":
    98     62.5 MiB      0.0 MiB           7                   _read_tags.append(Tag(device=str(registry), type=DT.SWORD))  # Signed Word = 16-bits
    99                                                     case "UWORD":
   100                                                         _read_tags.append(Tag(device=str(registry), type=DT.UWORD))  # Unsigned Word = 16-bits
   101                                                     case "SDWORD":
   102                                                         _read_tags.append(Tag(device=str(registry), type=DT.SDWORD))  # Signed Double Word = 32-bits
   103                                                     case "UDWORD":
   104                                                         _read_tags.append(Tag(device=str(registry), type=DT.UDWORD))  # Unsigned Double Word = 32-bits
   105                                                     case "FLOAT":
   106                                                         _read_tags.append(Tag(device=str(registry), type=DT.FLOAT))  # Floating Point 32-bits
   107                                                     case "DOUBLE":
   108                                                         _read_tags.append(Tag(device=str(registry), type=DT.DOUBLE))  # Double Integer 32-bits
   109                                                     case "SLWORD":
   110                                                         _read_tags.append(Tag(device=str(registry), type=DT.SLWORD))  # unknown
   111                                                     case "ULWORD":
   112                                                         _read_tags.append(Tag(device=str(registry), type=DT.ULWORD))  # unknown
   113                                                     case _:
   114                                                         to_error_log(f"Unrecognized data type for registry {registry}")
   115     62.5 MiB      0.0 MiB           1       return tuple(_read_tags)


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     62.7 MiB     62.7 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     62.7 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     62.7 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     62.7 MiB     62.7 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     62.7 MiB      0.0 MiB           1       try:
   135     66.5 MiB      3.8 MiB           4           conn = odbc.connect(f"""
   136     62.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     62.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     62.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.5 MiB      0.0 MiB           1           conn.close()
   144     66.5 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.5 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.5 MiB     66.5 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.5 MiB      0.0 MiB           1       try:
   295     66.5 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.5 MiB      0.0 MiB           4               f"""
   297     66.5 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.5 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.5 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.5 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.5 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.5 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.7 MiB      0.1 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.7 MiB      0.0 MiB           1           conn.commit()
   311     66.7 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.7 MiB      0.0 MiB           1           cursor.close()
   318     66.7 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.7 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.7 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.7 MiB      0.0 MiB           1       try:
   135     66.7 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.7 MiB      0.0 MiB           1           conn.close()
   144     66.7 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.7 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.7 MiB      0.0 MiB           1       try:
   295     66.7 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.7 MiB      0.0 MiB           4               f"""
   297     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.7 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.7 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.7 MiB      0.0 MiB           1           conn.commit()
   311     66.7 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.7 MiB      0.0 MiB           1           cursor.close()
   318     66.7 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.7 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.7 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.7 MiB      0.0 MiB           1       try:
   135     66.7 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.7 MiB      0.0 MiB           1           conn.close()
   144     66.7 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.7 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.7 MiB      0.0 MiB           1       try:
   295     66.7 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.7 MiB      0.0 MiB           4               f"""
   297     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.7 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.7 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.7 MiB      0.0 MiB           1           conn.commit()
   311     66.7 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.7 MiB      0.0 MiB           1           cursor.close()
   318     66.7 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.7 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.7 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.7 MiB      0.0 MiB           1       try:
   135     66.7 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.7 MiB      0.0 MiB           1           conn.close()
   144     66.7 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.7 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.7 MiB      0.0 MiB           1       try:
   295     66.7 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.7 MiB      0.0 MiB           4               f"""
   297     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.7 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.7 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.7 MiB      0.0 MiB           1           conn.commit()
   311     66.7 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.7 MiB      0.0 MiB           1           cursor.close()
   318     66.7 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.7 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.7 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.7 MiB      0.0 MiB           1       try:
   135     66.7 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.7 MiB      0.0 MiB           1           conn.close()
   144     66.7 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.7 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.7 MiB      0.0 MiB           1       try:
   295     66.7 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.7 MiB      0.0 MiB           4               f"""
   297     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.7 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.7 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.7 MiB      0.0 MiB           1           conn.commit()
   311     66.7 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.7 MiB      0.0 MiB           1           cursor.close()
   318     66.7 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.7 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.7 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.7 MiB      0.0 MiB           1       try:
   135     66.7 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.7 MiB      0.0 MiB           1           conn.close()
   144     66.7 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.7 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.7 MiB      0.0 MiB           1       try:
   295     66.7 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.7 MiB      0.0 MiB           4               f"""
   297     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.7 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.7 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.7 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.7 MiB      0.0 MiB           1           conn.commit()
   311     66.7 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.7 MiB      0.0 MiB           1           cursor.close()
   318     66.7 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.7 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.7 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.7 MiB      0.0 MiB           1       try:
   135     66.7 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.7 MiB      0.0 MiB           1           conn.close()
   144     66.7 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.7 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.7 MiB     66.7 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.7 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.7 MiB      0.0 MiB           4               f"""
   297     66.7 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.7 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.7 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     66.8 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     66.8 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     66.8 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.8 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.8 MiB      0.0 MiB           1           conn.close()
   144     66.8 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.8 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.8 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.8 MiB      0.0 MiB           4               f"""
   297     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.8 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.8 MiB      0.0 MiB           1           conn.close()
   144     66.8 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.8 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.8 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.8 MiB      0.0 MiB           4               f"""
   297     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.8 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.8 MiB      0.0 MiB           1           conn.close()
   144     66.8 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.8 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.8 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.8 MiB      0.0 MiB           4               f"""
   297     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.8 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.8 MiB      0.0 MiB           1           conn.close()
   144     66.8 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.8 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.8 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.8 MiB      0.0 MiB           4               f"""
   297     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.8 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.8 MiB      0.0 MiB           1           conn.close()
   144     66.8 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.8 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.8 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.8 MiB      0.0 MiB           4               f"""
   297     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.8 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.8 MiB      0.0 MiB           1           conn.close()
   144     66.8 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.8 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.8 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.8 MiB      0.0 MiB           4               f"""
   297     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.8 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.8 MiB      0.0 MiB           1           conn.close()
   144     66.8 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.8 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.8 MiB      0.0 MiB           1       try:
   295     66.8 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.8 MiB      0.0 MiB           4               f"""
   297     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.8 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.8 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.8 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.8 MiB      0.0 MiB           1           conn.commit()
   311     66.8 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.8 MiB      0.0 MiB           1           cursor.close()
   318     66.8 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     66.8 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     66.8 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     66.8 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.8 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.8 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.8 MiB     66.8 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.8 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.8 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.8 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.8 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     66.9 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     66.9 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     66.9 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     66.9 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     66.9 MiB      0.0 MiB           1           conn.close()
   144     66.9 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     66.9 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     66.9 MiB      0.0 MiB           1       try:
   295     66.9 MiB      0.0 MiB           2           conn = odbc.connect(
   296     66.9 MiB      0.0 MiB           4               f"""
   297     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     66.9 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     66.9 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     66.9 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     66.9 MiB      0.0 MiB           1           conn.commit()
   311     66.9 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     66.9 MiB      0.0 MiB           1           cursor.close()
   318     66.9 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     66.9 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     66.9 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     66.9 MiB     66.9 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     66.9 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     66.9 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     66.9 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     66.9 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.0 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.0 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.0 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.0 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.0 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.0 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.0 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.0 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.0 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.0 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.0 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.0 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.0 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.0 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.0 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.0 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.0 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.0 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.0 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.0 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.0 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.0 MiB      0.0 MiB           1       try:
   295     67.0 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.0 MiB      0.0 MiB           4               f"""
   297     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.0 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.0 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.0 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.0 MiB      0.0 MiB           1           conn.commit()
   311     67.0 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.0 MiB      0.0 MiB           1           cursor.close()
   318     67.0 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.0 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.0 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.0 MiB     67.0 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.0 MiB      0.0 MiB           1       try:
   135     67.0 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.0 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.0 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.0 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.0 MiB      0.0 MiB           1           conn.close()
   144     67.0 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.0 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.1 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.1 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.1 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.1 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.1 MiB      0.0 MiB           1           conn.close()
   144     67.1 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.1 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.1 MiB      0.0 MiB           1       try:
   295     67.1 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.1 MiB      0.0 MiB           4               f"""
   297     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.1 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.1 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.1 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.1 MiB      0.0 MiB           1           conn.commit()
   311     67.1 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.1 MiB      0.0 MiB           1           cursor.close()
   318     67.1 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.1 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.1 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.1 MiB     67.1 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.1 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.1 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.1 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.1 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.2 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.2 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.2 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.2 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.2 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.2 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.2 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.2 MiB      0.0 MiB           1           conn.commit()
   311     67.2 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.2 MiB      0.0 MiB           1           cursor.close()
   318     67.2 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.2 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.2 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.2 MiB      0.0 MiB           1       try:
   135     67.2 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.2 MiB      0.0 MiB           1           conn.close()
   144     67.2 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.2 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.2 MiB     67.2 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.2 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.2 MiB      0.0 MiB           4               f"""
   297     67.2 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.2 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.2 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.3 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.3 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.3 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.3 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.3 MiB      0.0 MiB           1           conn.close()
   144     67.3 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.3 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.3 MiB      0.0 MiB           1       try:
   295     67.3 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.3 MiB      0.0 MiB           4               f"""
   297     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.3 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.3 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.3 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.3 MiB      0.0 MiB           1           conn.commit()
   311     67.3 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.3 MiB      0.0 MiB           1           cursor.close()
   318     67.3 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.3 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.3 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.3 MiB     67.3 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.3 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.3 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.3 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.3 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    45     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    46                                         def to_error_log(message):
    47                                             '''
    48                                             Temporary event logger until implementation of logging logger
    49                                             For general exception logging.  Do not use for detailed debugging logs.
    50                                             For debugging, use to_debug_log().
    51                                             :param message: (string) Event log message
    52                                             '''
    53     67.4 MiB      0.0 MiB           1       error_log = open(f"{script_root_dir}\\errors.log", "a")
    54     67.4 MiB      0.0 MiB           1       error_log.write(f"{datetime.now()}: {message}")
    55     67.4 MiB      0.0 MiB           1       error_log.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.4 MiB      0.0 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.4 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.4 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.4 MiB      0.0 MiB           1       try:
   135     67.4 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.4 MiB      0.0 MiB           1           conn.close()
   144     67.4 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.4 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.4 MiB     67.4 MiB           1   @profile(stream=fp)
   283                                         def to_remote_sql(plc_host, tag_name, register, num_val=None, str_val=None):
   284                                             """
   285                                                 Sends tag information to REMOTE database.
   286                                                     Note: This function should be used to store data as a Main DB.
   287                                                 :param plc_host: (string)
   288                                                 :param tag_name: (string)
   289                                                 :param register: (string)
   290                                                 :param num_val: (float)
   291                                                 :param str_val: (string)
   292                                                 :return: Function does not return a value.
   293                                                 """
   294     67.4 MiB      0.0 MiB           1       try:
   295     67.4 MiB      0.0 MiB           2           conn = odbc.connect(
   296     67.4 MiB      0.0 MiB           4               f"""
   297     67.4 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   298     67.4 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   299     67.4 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   300                                                         Trust_Connection=yes;
   301                                                         uid=svc_storeandforward;
   302                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   303                                                         """
   304                                                 )
   305     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   306     67.4 MiB      0.0 MiB           1           params = [plc_host, tag_name, register, num_val, str_val]  # coming from other function
   307     67.4 MiB      0.0 MiB           1           cursor = conn.cursor()
   308     67.4 MiB      0.0 MiB           1           (cursor.execute("{CALL p_StoreTagValue(?, ?, ?, ?, ?)}", params))
   309                                                 # Commit the changes
   310     67.4 MiB      0.0 MiB           1           conn.commit()
   311     67.4 MiB      0.0 MiB           1           print(f"{datetime.now()}: Added host '{plc_host}' data to remote database")
   312                                             except Exception as e:
   313                                                 print(f"An error occurred: {e}")
   314                                                 to_error_log(f'{datetime.now()}: {e}')  # Write to application log file
   315                                             finally:
   316                                                 # Close the cursor and connection when done
   317     67.4 MiB      0.0 MiB           1           cursor.close()
   318     67.5 MiB      0.1 MiB           1           conn.close()


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    68     67.5 MiB     67.5 MiB           1   @profile(stream=fp)
    69                                         def is_numeric(value):
    70                                             """
    71                                             Accepts any value and determines if it is a string or numeric.
    72                                             :param value:
    73                                             :return: boolean
    74                                             """
    75     67.5 MiB      0.0 MiB           1       if isinstance(value, float) or isinstance(value, int):
    76     67.5 MiB      0.0 MiB           1           return True
    77                                             else:
    78                                                 if value.replace(".", "").isnumeric():
    79                                                     return True
    80                                                 else:
    81                                                     return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   132     67.5 MiB     67.5 MiB           1   @profile(stream=fp)
   133                                         def connection_verification():
   134     67.5 MiB      0.0 MiB           1       try:
   135     67.5 MiB      0.0 MiB           4           conn = odbc.connect(f"""
   136     67.5 MiB      0.0 MiB           1                   DRIVER={{{'SQL SERVER'}}};
   137     67.5 MiB      0.0 MiB           1                   SERVER={'S-MES-DB-DEV'};
   138     67.5 MiB      0.0 MiB           1                   DATABASE={'LocalTagStore'};
   139                                                         Trust_Connection=yes;
   140                                                         uid=svc_storeandforward;
   141                                                         pwd=weG3RxkrNIVTjHc1vsOD;
   142                                                         """)
   143     67.5 MiB      0.0 MiB           1           conn.close()
   144     67.5 MiB      0.0 MiB           1           print(f"\n{conn}")
   145     67.5 MiB      0.0 MiB           1           return True
   146                                             except Exception as e:
   147                                                 print(f"\nAn error occurred with remote db: {e}")
   148                                                 return False


Filename: C:\Users\ramonsaturnino\Documents\test\mitsubishiStoreAndForward\main.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   282     67.5 MiB     67.5 MiB           1   @profile(stream=fp)
